<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title>Document</title>
</head>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=Hl9ilifpSS4R092AugXaUPXGztehYAML"></script>
<link rel="stylesheet" href="../css/index.css">
<body>
    <div id="allmap"></div> 
	<div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none; position: absolute; top: 150px;"></div>
    <div id="r-result">
        <input type="text" id="suggestId" size="20" value="百度" />
        <button id="searchID">搜索</button>
        <a href="./navigation.html"><button id="navigation">导航</button></a>
    </div>
    <div id="s-result"></div>
    <div id="userAvatar"><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1560079006087&di=86350f0eecac70820bb7a7c84cf81654&imgtype=0&src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201609%2F16%2F20160916154847_3YfGx.jpeg" alt=""></div>
    <div id="chooseProject" onclick="showDiv()">
        <img src="../img/设置.png" alt="">
        <p style="display: inline">信息</p>
        <img src="../img/箭头.png" alt="" id="changeimg">
    </div>
    <div id="choose">
        <ul id="widget-menu"  style="display: none; ">
            <li id="deviceInfo">
                <img src="../img/眼睛.png" alt="">
                <a href="./deviceInfo.html"><p style="display: inline">设备信息</p></a>
            </li>
            <li id="weather">
                <img src="../img/天气.png" alt="">
                <p style="display: inline">天气</p>
            </li>
            <li id="MonitorInfo">
                <img src="../img/监控.png" alt="">
                <a href="./MonitorInfo.html"><p style="display: inline">监控信息</p></a>
            </li>
        </ul>
    </div>
</body>
</body>
<script type="text/javascript">
   function showDiv(){
        var obj_lis = document.getElementById("widget-menu").getElementsByTagName("li");
        for(i=0;i<obj_lis.length;i++){
            obj_lis[i].onclick = function(){
                document.getElementById('chooseProject').innerHTML = this.innerHTML;
                document.getElementById('widget-menu').style.display = "none";
            }
        }
        var a = document.getElementById('widget-menu').style.display;
        if(a=="block"){
            document.getElementById('widget-menu').style.display = "none";
        }else{
            document.getElementById('widget-menu').style.display = "block";
        }
       }  


	// 百度地图API功能
    function G(id) {
		return document.getElementById(id);
	}


	var map = new BMap.Map("allmap",{minZoom:20,maxZoom:17});
	var point = new BMap.Point(126.627938, 45.715051);
	map.centerAndZoom(point,17);



    var ac = new BMap.Autocomplete(    //建立一个自动完成的对象
		{"input" : "suggestId"
		,"location" : map
	});
    ac.addEventListener("onhighlight", function(e) {  //鼠标放在下拉列表上的事件
	var str = "";
		var _value = e.fromitem.value;
		var value = "";
		if (e.fromitem.index > -1) {
			value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
		}    
		str = "FromItem<br />index = " + e.fromitem.index + "<br />value = " + value;
		
		value = "";
		if (e.toitem.index > -1) {
			_value = e.toitem.value;
			value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
		}    
		str += "<br />ToItem<br />index = " + e.toitem.index + "<br />value = " + value;
		G("searchResultPanel").innerHTML = str;
	});

	var myValue;
	ac.addEventListener("onconfirm", function(e) {    //鼠标点击下拉列表后的事件
	var _value = e.item.value;
		myValue = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
		G("searchResultPanel").innerHTML ="onconfirm<br />index = " + e.item.index + "<br />myValue = " + myValue;
		setPlace(myValue);
	});


    var searchID = document.getElementById("searchID");
    searchID.addEventListener("click",function(){
        var inputValue = document.getElementById("suggestId").value; 
        setPlace(inputValue);
    });

	function setPlace(myValue){
	var local = new BMap.LocalSearch(map, {
		renderOptions:{map: map, panel:"s-result"},
		pageCapacity:5
	});
	local.search(myValue);
	}

	map.enableScrollWheelZoom(); 


</script>
</html>